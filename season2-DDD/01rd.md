# エリックエヴァンス ドメイン駆動設計 第1回
## 前書き

### ドメイン駆動設計
複雑さへの対処⇒複雑さは技術が生み出しているのではなく、業務がの複雑さが生み出している。

ドメイン (経営学) - 企業が経営活動を行って存続していくための事業領域を指す。

### 2つのプラクティス
開発がイテレーティブであること
開発者とドメインエキスパートが密接にかかわっていること（ドメインの深い洞察と集中すべき主要な概念の反映がモデル構築に必要なため

### 本書で得るもの
オブジェクトモデリングがソフトウェアプロジェクトにおける理論と実践の隙間を埋める

### モデルの意義
情報量と複雑さに対抗するツール。

標準化させることにより、保守性、コミュニケーションの容易性

# 第1部の目的
ドメイン駆動開発の基本的な目標を紹介する。
コミュニケーションと設計を推進するためにドメインモデルを使用することがどういう意味を持つか概観する

## 第1章
###PCB開発の話
ひたすらに要件の本筋を確認し、プロトタイプを作成する。
プロトタイプをドメインエキスパートに見せることで、彼らのモデルとソフトウェアへの理解度が高まる。

###重要視されるもの
_1. モデルと実装の結びつき_
_2. モデルに基づいた言語の構築_
_3. 様々な知識を吸収したモデルを構築_
_4. 本質を追加し、本質ではなかったものを削除していく_
_5. 議論の場で、ドメインへの理解を測る_
　⇒知識をかみ砕きモデルへと変換していく。（モデルはプロトタイプに落とし込む）


###良いドメインモデルを作るために
複雑なビジネスモデルをかみ砕き本質を抽出しプロトタイプを作る。__重要度とシンプルさがネック__

>従来法の悪　ビジネスエキスパート⇒アナリスト⇒プログラマー　この相互のフィードバックが欠けるため。
>⇒イテレーティブなプロセスを経て、知識を抽象化する。
（知識の抽象化のイメージ定義：おそらくビジネスの構成要素を一般化し、システム化することを意味している。）

モデルは要件を分析することで、情報の体系するツールとしての機能を果たす。
故に完成はなく、進化するものである。

ソフトウェアを開発するとき、開発者はドメインをどれだけ理解できていないかを知らない。
この無知が誤った想定を産み出す。また、人の変動も知識の蓄積を阻害する。

###一つの成功例として
ドメインエキスパートもモデルを学ぶことでドメインの中核を理解し、アプリケーションの目標が明確になった。

###オーバーブッキングポリシーの例
単に数式でエラーを示せばよい、というわけではない。
業務のルールをコード化する。（コードの比較）

###意識づけ的な結論？
__数式だとドメインエキスパートは理解しづらいが、ルール形式であればその道のプロなので理解しやすい。__


###第1章最終部の意味
開発者の目線：荷物の物理的な移動
ドメインエキスパートの視線：下請け会社の担う部分は物理的な問題ではなく責任の転嫁がより重要な問題。
※物理的な移動の管理が全く必要なわけではなかったかもしれないが、会社のビジネスモデル上は直接的な関係はない。

###第1章のまとめ
__正しい処理を返すことではなく、業務フローやルールをコード化しなさい。__

##第2章
ドメインエキスパートと開発者間だけではなく、ドメインエキスパート同士、開発者間同士でも共通言語を使用していることは前提とできない。
そのため、共通言語が必要だが、ドメインモデルはそれを満たし得る。（ただし、意図的にする必要がある。）

この共通な言語を__ユビキタス言語__という。


###ユビキタス言語の語彙
クラスや主要な操作の名前
明示されたルール

ユビキタス言語の形成には、関係者で厳格かつ統一的な利用が必要である。（文学的な言いかえは厳禁）
そのため、普段の会話やタスク管理上等でも表現を統一する。

###開発の中で用語の変更
ユビキタス言語を利用していると、当然齟齬が発生することもある。（この齟齬があることに気付けることも
ユビキタス言語の重要な効果）

定義の変更もあるが、基の定義では表現内容に過不足があった場合別の表現に置き換える
その場合、クラス図を変更し、コードのクラスやメソッドを変更する必要も出てくる。

ユビキタス言語の変更はモデルの変更を必ず意味する。


>開発者とドメインエキスパートの会話の比較は何となくの理解
>統一的であること、ルールに基づいていること、シンプルであることで成り立っていることはわかるかな。

###ユビキタス言語は、文字通りの言語のみでなくモデルも含めて初めて構成される。（視覚的、空間的能力）

・ドメインエキスパートが理解できないモデルは、原則モデルに問題があると考えるべき。

・モデルの言語を利用してのウォークスルーはシナリオテストも兼ねる。

・ドメインは、ビジネスモデルと共に変化する。故に、ユビキタス言語も変化し続ける必要がある。


###レビュー時の図の活用
UML図は関係性を表せるが、定義は表現できない。
略式のUML図で3～5のオブジェクトを基盤として用いれば、的となるため共通認識ができる

但し、図では情報量が少なすぎるため（関係性は見える）、制約と目的はテキストに頼ることになる。

つまり__図とはコミュニケーションと説明のための手段でブレインストーミングを容易にする。__
図は、余計なものがないときに使える（制約事項）
骨格の説明では使える


不変なドキュメントは作れない。
ビジネスモデルの変化に対応ができない為


コードには曖昧さがないため嘘や誤認がない。
__コミュニケーションの媒体としての機能をコードに置くと、クリーンで透過的に保とうという意識が形成される。（文化だよねー)__

しかし、_コードは曖昧さがなくても理解がしやすいわけではない。_
ドキュメントは、コードが達成している曖昧さの排除を目的とするべきではない。

ドキュメントの基本形：図にクラスとその責務をテキストで示す。
重要なテーマに焦点を与えるもの

###設計ドキュメントの目的は、モデルの概念を説明すること。

ドキュメント作成上のルール：ユビキタス言語（プロジェクトで使われている言葉）と
コードで使われている言葉で構成されている。（軸として）

__改めてコードは正しいことをするものではなく、正しいことを言うものでなければならない。__

クラス図について説明して


###機能として正しいものを積み上げると肥大化し、保守性を欠くようになる。

ドメイン⇔モデル⇔コード　距離が近く、言語の統一性
この緊密性がないと、モデルが設計の正しさを保証しない。

当然ながら開発者とドメインエキスパートも距離が近い必要がある。
ここが分離されると、分析が製造段階で無駄になる可能性が高く、開発者も再度分析が必要になる。

モデル駆動設計とビジネス分析の両立を図らなくてはならない

__P.47下部が最終的な結論かな。__


P.51からの実例をやってみたい。


###P.57から
分離は良くないよ。引継ぎで情報は失われるし、フィードバックが得にくいので、改善点が見えづらい。
フィードバックがないと、コーダーは自分で解決するので、モデルとしての統一性は失われる。モデルは単一であるべきの原則から外れる


コードを変更するとモデルも変更されることは周知されるべき。
そして、モデルを意識することを根付かせなくてはならない。

